

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="Description" content="Ember.js的中文开发者交流平台，提供Ember.js官方网站指南和API的中文翻译，持续关注最近的社区动态，为您提供高质量的Ember.js中文资料。 " />
    <meta name="Keywords" content="Ember.js、Ember、Javascript、Javascript框架、HTML、论坛、博客、中文社区" />
    <title>Ember.js - 查询参数</title>
    <meta property="st:title" content="查询参数" />
    <link rel="shortcut icon" href="/images/favicon.png" />
    <!--[if lte IE 7 ]><link href="/stylesheets/fonts/fontello-ie7.css" media="screen" rel="stylesheet" type="text/css" /><![endif]-->
    <link href="/stylesheets/site.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="/stylesheets/emberjs-cn.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="http://emberjs.cn/blog/feed.xml" rel="alternate" type="application/atom+xml" title="Ember.js CN - 博客" />

    
  </head>

  <body class="bilingual_guides bilingual_guides_routing bilingual_guides_routing_query-params bilingual_guides_routing_query-params_index">
    <div id="header">
      <div id="wrapper">
        <a id="logo" href="/">&nbsp;</a>
        <ul id="nav">
          <li><a href="/guides">指南</a></li>
          <li>
            <a target="_blank" href="http://discuss.emberjs.cn">论坛</a>
          </li>
          <li><a href="/blog">博客</a></li>
          <li>
            <a target="_blank" href="http://devdocs.io/ember/">API文档</a>
          </li>
          <li><a href="/builds">构建</a></li>
        </ul>
        <div id="github">
          <a href="https://github.com/emberjs-cn"><img src="/images/fork-us.png">Fork Us!</a>
          <a href="https://github.com/emberjs/ember.js"><img src="/images/fork-us.png">Fork Ember!</a>
        </div>
      </div>
    </div>

    <div id="content-wrapper">
      
      
        <div id="sidebar">
          
    <ol id="toc-list">
          <li class="level-1">
            <a href="/bilingual_guides/getting-started">入门指南</a>
            <ol>
        
            <li class="level-3">
              <a href="/bilingual_guides/getting-started">介绍</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/planning-the-application">应用规划</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/creating-a-static-mockup">创建静态页面</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/obtaining-emberjs-and-dependencies">获取Ember.js和相应依赖</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/adding-a-route-and-template">添加第一个路由与模板</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/modeling-data">建立模型</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/using-fixtures">使用静态数据</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/displaying-model-data">显示模型数据</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/displaying-a-models-completeness">显示模型的完成状态</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/creating-a-new-model">创建新的模型实例</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/marking-a-model-as-complete-incomplete">标记模型为完成或未完成</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/displaying-the-number-of-incomplete-todos">显示未完成待办事项的数量</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/toggle-todo-editing-state">切换显示和编辑状态</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/accepting-edits">接受修改</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/deleting-todos">删除模型</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/adding-child-routes">添加子路由</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/show-only-incomplete-todos">显示未完成待办事项</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/show-only-complete-todos">显示已完成待办事项</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/show-all-todos-again">显示所有待办事项</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/display-a-button-to-remove-completed-todos">添加移除所有已完成待办事项的按钮</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/show-when-all-todos-are-complete">提示所有待办事项已完成</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/toggle-all-todos">切换已完成和未完成待办事项</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/getting-started/using-other-adapters">更换FixtureAdapter</a>
            </li>
          </ol></li>
          <li class="level-1">
            <a href="/bilingual_guides/getting-ember">获取Ember</a>
            <ol>
        
            <li class="level-3">
              <a href="/bilingual_guides/getting-ember">获取Ember</a>
            </li>
          </ol></li>
          <li class="level-1">
            <a href="/bilingual_guides/concepts/core-concepts">概念</a>
            <ol>
        
            <li class="level-3">
              <a href="/bilingual_guides/concepts/core-concepts">核心概念</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/concepts/naming-conventions">命名惯例</a>
            </li>
          </ol></li>
          <li class="level-1">
            <a href="/bilingual_guides/object-model/classes-and-instances">对象模型</a>
            <ol>
        
            <li class="level-3">
              <a href="/bilingual_guides/object-model/classes-and-instances">类与实例</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/object-model/computed-properties">计算属性</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/object-model/computed-properties-and-aggregate-data">计算属性和带@each的集合数据</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/object-model/observers">观察器</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/object-model/bindings">绑定</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/object-model/reopening-classes-and-instances">重新打开类和实例</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/object-model/what-do-i-use-when">绑定，观察器，计算属性：如何选择？</a>
            </li>
          </ol></li>
          <li class="level-1">
            <a href="/bilingual_guides/application">应用</a>
            <ol>
        
            <li class="level-3">
              <a href="/bilingual_guides/application">介绍</a>
            </li>
          </ol></li>
          <li class="level-1">
            <a href="/bilingual_guides/templates/the-application-template">模板</a>
            <ol>
        
            <li class="level-3">
              <a href="/bilingual_guides/templates/the-application-template">应用模板</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/templates/handlebars-basics">Handlebars基础</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/templates/conditionals">条件表达式</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/templates/displaying-a-list-of-items">显示项目列表</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/templates/changing-scope">切换作用域</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/templates/binding-element-attributes">绑定元素属性</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/templates/binding-element-class-names">绑定元素类名称</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/templates/links">链接</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/templates/actions">操作</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/templates/input-helpers">输入助手</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/templates/development-helpers">开发助手</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/templates/rendering-with-helpers">用助手来渲染</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/templates/writing-helpers">编写助手方法</a>
            </li>
          </ol></li>
          <li class="level-1 selected">
            <a href="/bilingual_guides/routing">路由</a>
            <ol class='selected'>
        
            <li class="level-3">
              <a href="/bilingual_guides/routing">介绍</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/routing/defining-your-routes">定义路由</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/routing/generated-objects">生成的对象</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/routing/specifying-a-routes-model">指定路由的模型</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/routing/setting-up-a-controller">设置控制器</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/routing/rendering-a-template">渲染模板</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/routing/redirection">重定向</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/routing/specifying-the-location-api">指定地址API</a>
            </li>
          
            <li class="level-3 sub-selected">
              <a href="/bilingual_guides/routing/query-params">查询参数</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/routing/asynchronous-routing">异步路由</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/routing/loading-and-error-substates">加载中/错误子状态</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/routing/preventing-and-retrying-transitions">阻止和重试过渡</a>
            </li>
          </ol></li>
          <li class="level-1">
            <a href="/bilingual_guides/components">组件</a>
            <ol>
        
            <li class="level-3">
              <a href="/bilingual_guides/components">介绍</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/components/defining-a-component">定义组件</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/components/passing-properties-to-a-component">传递属性</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/components/wrapping-content-in-a-component">包裹内容</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/components/customizing-a-components-element">自定义组件元素</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/components/handling-user-interaction-with-actions">使用Action处理用户交互</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/components/sending-actions-from-components-to-your-application">从组件发送操作给应用</a>
            </li>
          </ol></li>
          <li class="level-1">
            <a href="/bilingual_guides/controllers">控制器</a>
            <ol>
        
            <li class="level-3">
              <a href="/bilingual_guides/controllers">介绍</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/controllers/representing-a-single-model-with-objectcontroller">代表单一模型</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/controllers/representing-multiple-models-with-arraycontroller">代表多模型</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/controllers/dependencies-between-controllers">管理控制器间的依赖</a>
            </li>
          </ol></li>
          <li class="level-1">
            <a href="/bilingual_guides/models">模型</a>
            <ol>
        
            <li class="level-3">
              <a href="/bilingual_guides/models">介绍</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/models/defining-models">定义模型</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/models/creating-and-deleting-records">创建和删除记录</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/models/pushing-records-into-the-store">将记录推入仓库</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/models/persisting-records">持久化记录</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/models/finding-records">查询记录</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/models/working-with-records">使用记录</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/models/the-fixture-adapter">使用Fixture</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/models/connecting-to-an-http-server">连接HTTP服务器</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/models/handling-metadata">处理元数据</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/models/customizing-adapters">自定义适配器</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/models/frequently-asked-questions">常见问题</a>
            </li>
          </ol></li>
          <li class="level-1">
            <a href="/bilingual_guides/views">视图</a>
            <ol>
        
            <li class="level-3">
              <a href="/bilingual_guides/views">介绍</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/views/defining-a-view">定义视图</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/views/handling-events">处理事件</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/views/inserting-views-in-templates">在模板中插入视图</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/views/adding-layouts-to-views">为视图添加布局</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/views/customizing-a-views-element">自定义视图元素</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/views/built-in-views">内置视图</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/views/manually-managing-view-hierarchy">手动管理视图层级</a>
            </li>
          </ol></li>
          <li class="level-1">
            <a href="/bilingual_guides/enumerables">枚举</a>
            <ol>
        
            <li class="level-3">
              <a href="/bilingual_guides/enumerables">介绍</a>
            </li>
          </ol></li>
          <li class="level-1">
            <a href="/bilingual_guides/testing">测试</a>
            <ol>
        
            <li class="level-3">
              <a href="/bilingual_guides/testing">介绍</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/testing/integration">集成测试</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/testing/test-helpers">测试助手</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/testing/testing-user-interaction">测试用户交互</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/testing/unit">单元测试</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/testing/unit-testing-basics">单元测试基础</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/testing/testing-components">测试组件</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/testing/testing-controllers">测试控制器</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/testing/testing-routes">测试路由</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/testing/testing-models">测试模型</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/testing/test-runners">自动化测试</a>
            </li>
          </ol></li>
          <li class="level-1">
            <a href="/bilingual_guides/configuring-ember/disabling-prototype-extensions">配置Ember.js</a>
            <ol>
        
            <li class="level-3">
              <a href="/bilingual_guides/configuring-ember/disabling-prototype-extensions">禁用基本类型扩展</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/configuring-ember/embedding-applications">嵌入式应用</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/configuring-ember/feature-flags">特性标识</a>
            </li>
          </ol></li>
          <li class="level-1">
            <a href="/bilingual_guides/cookbook">Cookbook</a>
            <ol>
        
            <li class="level-3">
              <a href="/bilingual_guides/cookbook">简介</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/cookbook/user_interface_and_interaction">用户界面与交互</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/cookbook/event_handling_and_data_binding">事件处理和数据绑定</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/cookbook/helpers_and_components">助手与组件</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/cookbook/working_with_objects">使用对象</a>
            </li>
          </ol></li>
          <li class="level-1">
            <a href="/bilingual_guides/understanding-ember/the-view-layer">理解Ember.js</a>
            <ol>
        
            <li class="level-3">
              <a href="/bilingual_guides/understanding-ember/the-view-layer">视图层</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/understanding-ember/managing-asynchrony">管理异步</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/understanding-ember/keeping-templates-up-to-date">模板自动更新</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/understanding-ember/debugging">调试</a>
            </li>
          
            <li class="level-3">
              <a href="/bilingual_guides/understanding-ember/run-loop">运行循环</a>
            </li>
          </ol></li></ol>
  
          <div id="back-to-top"><a id="back-top-top" href="#">&#11014; 返回顶部</a></div>
        </div>
      
      <div id="content" class="has-sidebar">
          
  

  <div class="chapter">
    
        <h1>查询参数 
          <a href="https://github.com/emberjs-cn/www.emberjs.cn/tree/master/source/guides/routing/query-params.md" target="_blank" class="edit-page">
            编辑页面</a>
        </h1>
      
    <p>In general, the dynamic segments of a URL are a serialized representation of a model, commonly the model&#39;s ID. However, sometimes you need to serialize other application state into the URL. This could be further parameters that affect the loading of the model from the server, e.g. what page of a result set you are viewing, or it could be information about client side state, e.g. sort order when the records are sorted on the client.</p>

<p>通常情况下，URL的动态段是模型的一种序列化表示，最常见的是模型的ID。然后，有时候还需要将应用的其他状态也序列化到URL中。这可能是对从服务器端加载模型有影响的一些参数，比如要查看的是那一页结果；也可能是一些关于客户端状态的信息，比如在客户端实现排序时的记录排序规则。</p>

<p>There can also be more global information that you want to serialize into the url, for example if you want to store an auth token in the URL, or filter all models in your application globally. It&#39;s also possible that there is a lot of parameters that you want to serialize in the url that are inconvenient to store in normal dynamic segments. This might apply when you have a map view and need to store X, Y, and zoom coordinates along with a set of visible layers on the map. Although this is possible to do with dynamic segments, it can be inconvenient. For any of these use cases, you can consider using query params instead.</p>

<p>当然URL中还可以被序列化一些更为全局性的信息，例如包含一个身份令牌到URL中，或者在应用里全局的过滤模型。除此之外，还可以包含任何不适合包含在常规动态段中的一些参数。必须在一个地图视图上，可能需要保存一系列在地图上可见图层的横坐标、纵坐标和缩放比例等参数。虽然这些也可以通过动态段来实现，不过那样就显得不那么自然。对于这样的一些应用场景，就可以考虑使用查询参数来替代了。</p>
<h3 class='anchorable-toc' id='toc_query-parameters-are-controller-driven'>Query Parameters are Controller-Driven</h3><h3 class='anchorable-toc' id='toc_'>控制器驱动查询参数</h3>
<p>Support for query parameters is built right into controllers, unlike
other aspects of the URL which are specified and managed entirely at
the router level. First class support for query params at the
controller level allows for a simple yet powerful API for updating and
responding to changes in query params without requiring the developer to
manually install and manage bindings/observers to keep the URL and
controller state in sync.</p>

<p>对查询参数的支持被内置到控制器中，这与在路由层指定和管理的URL的其他部分不同。在控制器层实现的对查询参数的一流支持，使得可以提供一个强大的API来更新和响应查询参数的变更，而不需要开发者手动的安装和管理绑定/观察器来保持URL与控制器状态的同步。</p>
<h3 class='anchorable-toc' id='toc_specifying-query-parameters'>Specifying Query Parameters</h3><h3 class='anchorable-toc' id='toc_'>指定查询参数</h3>
<p>Query params can be specified by route-driven controllers. Recall that,
given a route specified by <code>this.route(&#39;articles&#39;);</code>, the value resolved
from the <code>ArticlesRoute</code>&#39;s <code>model</code> hook will be loaded into
<code>ArticlesController</code> as its <code>model</code> property. While <code>ArticlesRoute</code> has
the option of loading data into different controllers in the
<code>setupController</code> hook, <code>ArticlesController</code> is considered to be the
&quot;route-driven&quot; controller in this case, and therefore has the ability to
specify query params.</p>

<p>查询参数可以通过路由驱动的控制器来设置。回想一下，给定一个<code>this.route(&#39;articles&#39;);</code>指定的路由，<code>ArticlesRoute</code>的<code>model</code>钩子获取到的值将被加载到<code>ArticlesController</code>作为<code>model</code>属性。虽然<code>ArticlesRoute</code>可以在<code>setupController</code>钩子中加载数据到其他的控制器，但<code>ArticlesController</code>被认为是“路由驱动”的控制器，因此能够设定查询参数。</p>

<p><aside>
  <strong>Note:</strong> The controller associated with a given route can be changed
  by specifying the <code>controllerName</code> property on that route.</p>

<p><strong>注意：</strong> 给定的路由关联的控制器可以通过路由的<code>controllerName</code>属性来指定。
</aside></p>

<p>Let&#39;s say we&#39;d like to add a <code>category</code>
query parameter that will filter out all the articles that haven&#39;t
been categorized as popular. To do this, we specify <code>&#39;category&#39;</code>
as one of <code>ArticlesController</code>&#39;s <code>queryParams</code>:</p>

<p>这里假设需要添加一个<code>category</code>查询参数，用来过滤那些没有被分类到流行的分类的文章。为了实现这个功能，可以指定<code>&#39;category&#39;</code>为<code>ArticlesController</code>的<code>queryParams</code>：</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
</pre></td>
  <td class="code"><pre>App.ArticlesController = Ember.ArrayController.extend({
  <span class="key">queryParams</span>: [<span class="string"><span class="delimiter">'</span><span class="content">category</span><span class="delimiter">'</span></span>],
  <span class="key">category</span>: <span class="predefined-constant">null</span>
});
</pre></td>
</tr></table>
</div></div>
<p>This sets up a binding between the <code>category</code> query param in the URL,
and the <code>category</code> property on <code>ArticlesController</code>. In other words,
once the <code>articles</code> route has been entered, any changes to the
<code>category</code> query param in the URL will update the <code>category</code> property
on <code>ArticlesController</code>, and vice versa.</p>

<p>上述代码设定了URL查询参数<code>category</code>与<code>ArticlesController</code>的<code>category</code>属性之间的绑定。换句话说，当进入到<code>articles</code>路由时，URL中查询参数<code>category</code>的改变都会自动更新<code>ArticlesController</code>中的<code>category</code>属性，反之亦然。</p>

<p>Now we just need to define a computed property of our category-filtered
array that <code>articles</code> template will render:</p>

<p>接下来只需要定义一个<code>articles</code>模板渲染时需要使用的分类数组的计算属性即可：</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
</pre></td>
  <td class="code"><pre>App.ArticlesController = Ember.ArrayController.extend({
  <span class="key">queryParams</span>: [<span class="string"><span class="delimiter">'</span><span class="content">category</span><span class="delimiter">'</span></span>],
  <span class="key">category</span>: <span class="predefined-constant">null</span>,

  <span class="function">filteredArticles</span>: <span class="keyword">function</span>() {
    <span class="keyword">var</span> category = <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">category</span><span class="delimiter">'</span></span>);
    <span class="keyword">var</span> articles = <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">model</span><span class="delimiter">'</span></span>);

    <span class="keyword">if</span> (category) {
      <span class="keyword">return</span> articles.filterProperty(<span class="string"><span class="delimiter">'</span><span class="content">category</span><span class="delimiter">'</span></span>, category);
    } <span class="keyword">else</span> {
      <span class="keyword">return</span> articles;
    }
  }.property(<span class="string"><span class="delimiter">'</span><span class="content">category</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">model</span><span class="delimiter">'</span></span>)
});
</pre></td>
</tr></table>
</div></div>
<p>With this code, we have established the following behaviors:</p>

<p>上述代码主要完成了：</p>

<ol>
<li>If the user navigates to <code>/articles</code>, <code>category</code> will be <code>null</code>, so
the articles won&#39;t be filtered.</li>
<li>If the user navigates to <code>/articles?articles[category]=recent</code>,
<code>category</code> will be set to <code>&quot;recent&quot;</code>, so articles will be filtered.</li>
<li><p>Once inside the <code>articles</code> route, any changes to the <code>category</code>
property on <code>ArticlesController</code> will cause the URL to update the
query param. By default, a query param property change won&#39;t cause a
full router transition (i.e. it won&#39;t call <code>model</code> hooks and
<code>setupController</code>, etc.); it will only update the URL.</p></li>
<li><p>如果用户导航到<code>/articles</code>，<code>category</code>值为<code>null</code>，因此文章不会被过滤。</p></li>
<li><p>如果用户导航到<code>/articles?articles[category]=recent</code>，<code>category</code>被设置为<code>&quot;recent&quot;</code>，因此文章将被过滤。</p></li>
<li><p>一旦在<code>articles</code>路由里，改变<code>ArticlesController</code>中<code>category</code>属性的值，便会导致URL中对应的查询参数被更新。默认情况下，一个查询参数的改变并不会导致一次完整的路由过渡（例如：不会调用<code>model</code>和<code>setupController</code>钩子等）；只会更新URL。</p></li>
</ol>
<h3 class='anchorable-toc' id='toc_link-to-helper'>link-to Helper</h3><h3 class='anchorable-toc' id='toc_link-to'>link-to助手</h3>
<p>The <code>link-to</code> helper supports specifying query params by way of the
<code>query-params</code> subexpression helper.</p>

<p><code>link-to</code>助手通过<code>query-params</code>子表达式助手可以支持指定查询参数。</p>
<div class="highlight handlebars "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
</pre></td>
  <td class="code"><pre>// Explicitly set target query param
<span class="inline"><span class="inline-delimiter">{{#</span><span class="attribute-name">link-to</span> <span class="error">'</span><span class="attribute-name">posts</span><span class="error">'</span> <span class="error">(</span><span class="attribute-name">query-params</span> <span class="attribute-name">direction</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">asc</span><span class="delimiter">&quot;</span></span><span class="error">)</span><span class="inline-delimiter">}}</span></span>Sort<span class="inline"><span class="inline-delimiter">{{/</span><span class="attribute-name">link-to</span><span class="inline-delimiter">}}</span></span>

// Binding is also supported
<span class="inline"><span class="inline-delimiter">{{#</span><span class="attribute-name">link-to</span> <span class="error">'</span><span class="attribute-name">posts</span><span class="error">'</span> <span class="error">(</span><span class="attribute-name">query-params</span>
<span class="attribute-name">direction</span>=<span class="attribute-value">otherDirection</span><span class="error">)</span><span class="inline-delimiter">}}</span></span>Sort<span class="inline"><span class="inline-delimiter">{{/</span><span class="attribute-name">link-to</span><span class="inline-delimiter">}}</span></span>
</pre></td>
</tr></table>
</div></div>
<p>In the above examples, <code>direction</code> is presumably a query param property
on <code>PostsController</code>, but it could also refer to a <code>direction</code> property
on any of the controllers associated with the <code>posts</code> route hierarchy,
matching the leaf-most controller with the supplied property name.</p>

<p>上例中，<code>direction</code>是<code>PostsController</code>的一个假定的查询参数，它可以是<code>posts</code>路由层次结构上关联任意一个控制器的<code>direction</code>属性，该属性定义在匹配的一个叶节点控制器。</p>

<p><aside>
  <strong>Note:</strong> Subexpressions are only available in Handlebars 1.3
  or later.</p>

<p><strong>注意：</strong> 子表达式只在Handlebars 1.3或更高版本中支持。
</aside></p>

<p>The link-to helper takes into account query parameters when determining
its &quot;active&quot; state, and will set the class appropriately. The active
state
is determined by working out if you clicked on the link, would the query
params end up the same? You don&#39;t have to supply all of the current,
active query params for this to be true.</p>

<p><code>link-to</code>助手当判断其是否是<code>active</code>状态的时候会考虑查询参数，并正确的设定样式类。<code>active</code>状态在点击一个链接的时候被计算出来，那么查询参数是否也是一样呢？其实并不需要提供所有的当前的活跃的查询参数。</p>
<h3 class='anchorable-toc' id='toc_transitionto'>transitionTo</h3>
<p><code>Route#transitionTo</code> (and <code>Controller#transitionToRoute</code>) now
accepts a final argument, which is an object with
the key <code>queryParams</code>.</p>

<p><code>Route#transitionTo</code>（和<code>Controller#transitionToRoute</code>）增加了一个参数，该参数一个键值为<code>queryParams</code>的对象。</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
</pre></td>
  <td class="code"><pre><span class="local-variable">this</span>.transitionTo(<span class="string"><span class="delimiter">'</span><span class="content">post</span><span class="delimiter">'</span></span>, object, {<span class="key">queryParams</span>: {<span class="key">showDetails</span>: <span class="predefined-constant">true</span>}});
<span class="local-variable">this</span>.transitionTo(<span class="string"><span class="delimiter">'</span><span class="content">posts</span><span class="delimiter">'</span></span>, {<span class="key">queryParams</span>: {<span class="key">sort</span>: <span class="string"><span class="delimiter">'</span><span class="content">title</span><span class="delimiter">'</span></span>}});

<span class="comment">// if you just want to transition the query parameters without changing</span>
the route
<span class="local-variable">this</span>.transitionTo({<span class="key">queryParams</span>: {<span class="key">direction</span>: <span class="string"><span class="delimiter">'</span><span class="content">asc</span><span class="delimiter">'</span></span>}});
</pre></td>
</tr></table>
</div></div>
<p>You can also add query params to URL transitions:</p>

<p>当然也可以将查询参数加到URL过渡中：</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre><span class="local-variable">this</span>.transitionTo(<span class="string"><span class="delimiter">&quot;</span><span class="content">/posts/1?sort=date&amp;showDetails=true</span><span class="delimiter">&quot;</span></span>);
</pre></td>
</tr></table>
</div></div><h3 class='anchorable-toc' id='toc_opting-into-a-full-transition'>Opting into a full transition</h3><h3 class='anchorable-toc' id='toc_'>选择进入一个完整过渡</h3>
<p>Keep in mind that if the arguments provided to <code>transitionTo</code>
or <code>link-to</code> only correspond to a change in query param values,
and not a change in the route hierarchy, it is not considered a
full transition, which means that hooks like <code>model</code> and
<code>setupController</code> won&#39;t fire by default, but rather only
controller properties will be updated with new query param values, as
will the URL.</p>

<p>需要记住一点，<code>transitionTo</code>和<code>link-to</code>提供的参数只负责改变查询参数的值，并不改变路由的层次结构，也不会当做一个完整的过渡，这也就意味着<code>model</code>和<code>setupController</code>钩子默认不会被触发，仅仅会使用新的查询参数的值，更新控制器的属性的值和URL。</p>

<p>But some query param changes necessitate loading data from the server,
in which case it is desirable to opt into a full-on transition. To opt
into a full transition when a controller query param property changes, 
you can use the optional <code>queryParams</code> configuration hash on the <code>Route</code>
associated with that controller, and set that query param&#39;s
<code>refreshModel</code> config property to <code>true</code>:</p>

<p>但是也有时查询参数的改变需要重新从服务器端加载数据，这种情况下就需要一次完整的过渡。当控制器查询参数属性变化时，为了实现一个完整的过渡，可以使用·<code>Route</code>中与对应控制器关联的可选的<code>queryParams</code>配置哈希，并将查询参数的<code>refreshModel</code>配置属性设置为<code>true</code>：</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
</pre></td>
  <td class="code"><pre>App.ArticlesRoute = Ember.Route.extend({
  <span class="key">queryParams</span>: {
    <span class="key">category</span>: {
      <span class="key">refreshModel</span>: <span class="predefined-constant">true</span>
    }
  },
  <span class="function">model</span>: <span class="keyword">function</span>(params) {
    <span class="comment">// This gets called upon entering 'articles' route</span>
    <span class="comment">// for the first time, and we opt in refiring it</span>
    <span class="comment">// upon query param changes via `queryParamsDidChange` action</span>

    <span class="comment">// params has format of { category: &quot;someValueOrJustNull&quot; },</span>
    <span class="comment">// which we can just forward to the server.</span>
    <span class="keyword">return</span> <span class="local-variable">this</span>.store.findQuery(<span class="string"><span class="delimiter">'</span><span class="content">articles</span><span class="delimiter">'</span></span>, params);
  }
});

App.ArticlesController = Ember.ArrayController.extend({
  <span class="key">queryParams</span>: [<span class="string"><span class="delimiter">'</span><span class="content">category</span><span class="delimiter">'</span></span>],
  <span class="key">category</span>: <span class="predefined-constant">null</span>
});
</pre></td>
</tr></table>
</div></div><h3 class='anchorable-toc' id='toc_update-url-with-code-replacestate-code-instead'>Update URL with <code>replaceState</code> instead</h3><h3 class='anchorable-toc' id='toc_code-replacestate-code-url'>使用<code>replaceState</code>来更新URL</h3>
<p>By default, Ember will use <code>pushState</code> to update the URL in the
address bar in response to a controller query param property change, but
if you would like to use <code>replaceState</code> instead (which prevents an
additional item from being added to your browser&#39;s history), you can
specify this on the <code>Route</code>&#39;s <code>queryParams</code> config hash, e.g. (continued
from the example above):</p>

<p>缺省情况下，Ember使用<code>pushState</code>来更新地址栏中的URL来响应控制器查询参数属性的变化，然而也可以通过使用<code>replaceState</code>来实现（这会阻止在浏览器的历史中增加附加的条目），通过设定<code>Route</code>的<code>queryParams</code>配置哈希来启用，例如（接上例）：</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
</pre></td>
  <td class="code"><pre>App.ArticlesRoute = Ember.Route.extend({
  <span class="key">queryParams</span>: {
    <span class="key">category</span>: {
      <span class="key">replace</span>: <span class="predefined-constant">true</span>
    }
  }
});
</pre></td>
</tr></table>
</div></div>
<p>Note that the name of this config property and its default value of
<code>false</code> is similar to the <code>link-to</code> helper&#39;s, which also lets
you opt into a <code>replaceState</code> transition via <code>replace=true</code>. </p>

<p>需要注意配置属性名及其默认<code>false</code>值与<code>link-to</code>助手的相似，需要通过设定<code>replace=true</code>来启用<code>replaceState</code>过渡。</p>
<h3 class='anchorable-toc' id='toc_map-a-controller-s-property-to-a-different-query-param-key'>Map a controller&#39;s property to a different query param key</h3><h3 class='anchorable-toc' id='toc_'>将控制器的属性映射到不同的查询参数键值</h3>
<p>By default, specifying <code>foo</code> as a controller query param property will
bind to a query param whose key is <code>foo</code>, e.g. <code>?foo=123</code>. You can also map
a controller property to a different query param key using an optional
colon syntax similar to the <code>classNameBindings</code> syntax 
<a href="/guides/views/customizing-a-views-element/">demonstrated here</a>.</p>

<p>缺省情况下，指定<code>foo</code>作为控制器的查询参数属性将会绑定一个键值为<code>foo</code>的查询参数，例如<code>?foo=123</code>。采用类似<code>classNameBindings</code>的冒号语法<a href="/guides/views/customizing-a-views-element/">示例</a>可以将控制器的属性绑定到一个不同的查询参数键值。</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
</pre></td>
  <td class="code"><pre>App.ArticlesController = Ember.ArrayController.extend({
  <span class="key">queryParams</span>: [<span class="string"><span class="delimiter">'</span><span class="content">category:articles_category</span><span class="delimiter">'</span></span>],
  <span class="key">category</span>: <span class="predefined-constant">null</span>
});
</pre></td>
</tr></table>
</div></div>
<p>This will cause changes to the <code>ArticlesController</code>&#39;s <code>category</code>
property to update the <code>articles_category</code> query param, and vice versa.</p>

<p>上述代码会使得改变<code>ArticlesController</code>的<code>category</code>时更新<code>articles_category</code>查询参数，反之亦然。</p>
<h3 class='anchorable-toc' id='toc_default-values-and-deserialization'>Default values and deserialization</h3><h3 class='anchorable-toc' id='toc_'>默认值和反序列化</h3>
<p>In the following example, the controller query param property <code>page</code> is
considered to have a default value of <code>1</code>. </p>

<p>在下述例子中，控制器查询参数<code>page</code>默认值被设置为<code>1</code>。</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
3
4
</pre></td>
  <td class="code"><pre>App.ArticlesController = Ember.ArrayController.extend({
  <span class="key">queryParams</span>: <span class="string"><span class="delimiter">'</span><span class="content">page</span><span class="delimiter">'</span></span>,
  <span class="key">page</span>: <span class="integer">1</span>
});
</pre></td>
</tr></table>
</div></div>
<p>This affects query param behavior in two ways:</p>

<p>这对查询参数行为的影响有两种方式：</p>

<ol>
<li><p>The type of the default value is used to cast changed query param
values in the URL before setting values on the controller. So, given
the above example, if the user clicks the back button to change from
<code>/?page=3</code> to <code>/?page=2</code>, Ember will update the <code>page</code> controller
property to the properly cast number <code>2</code> rather than the string <code>&quot;2&quot;</code>, which it
knows to do because the default value (<code>1</code>) is a number. This also
allows boolean default values to be correctly cast when deserializing
from URL changes.</p></li>
<li><p>在设置控制器值前，会使用默认值的类型来完成在URL中的查询参数值的类型转换。因此，在给定的上例中，如果用户点击后退按钮使得URL从<code>/?page=3</code>变为<code>/?page=2</code>，Ember会采用转换后的数值<code>2</code>来更新控制器的<code>page</code>属性，而非字符串的<code>&quot;2&quot;</code>，这是因为默认值<code>1</code>是数值型。这也使得布尔型参数的缺省值能在反序列化的时候被正确的转换。</p></li>
<li><p>When a controller&#39;s query param property is currently set to its
default value, this value won&#39;t be serialized into the URL. So in the
above example, if <code>page</code> is <code>1</code>, the URL might look like <code>/articles</code>,
but once someone sets the controller&#39;s <code>page</code> value to <code>2</code>, the URL
will become <code>/articles?page=2</code>.</p></li>
<li><p>当控制器的查询参数被设置为默认值时，该值不会被序列化到URL中。因此在上例中，如果<code>page</code>值为<code>1</code>，URL可能就是<code>/articles</code>，但是如果<code>page</code>的值被设置为<code>2</code>，那么URL应该就是<code>/articles?page=2</code>。</p></li>
</ol>
<h2 class='anchorable-toc' id='toc_examples'>Examples</h2><h2 class='anchorable-toc' id='toc_'>示例</h2>
<ul>
<li><a href="http://emberjs.jsbin.com/ucanam/4059">Search queries</a></li>
<li><a href="http://emberjs.jsbin.com/ucanam/2937">Sort: client-side, no refiring of model hook</a></li>
<li><a href="http://emberjs.jsbin.com/ucanam/4073">Sort: server-side, refire model hook</a></li>
<li><a href="http://emberjs.jsbin.com/ucanam/4075">Pagination + Sorting</a></li>
<li><a href="http://emberjs.jsbin.com/ucanam/4076/edit">Boolean values</a></li>
<li><a href="http://emberjs.jsbin.com/ucanam/4077/edit">Global query params on app route</a></li>
<li><a href="http://emberjs.jsbin.com/ucanam/4079/edit">Opt-in to full transition via refreshModel:true</a></li>
<li><a href="http://emberjs.jsbin.com/ucanam/4080/edit">opt into replaceState via replace:true</a></li>
<li><a href="http://emberjs.jsbin.com/ucanam/4081">w/ {{partial}} helper for easy tabbing</a></li>
<li><a href="http://emberjs.jsbin.com/ucanam/4082#/about?showThing=true">link-to with no route name, only QP change</a></li>
<li><a href="http://emberjs.jsbin.com/ucanam/4083/edit">Complex: serializing textarea content into URL (and subexpressions))</a></li>
<li><a href="http://emberjs.jsbin.com/ucanam/4084">Arrays</a></li>
<li><p><a href="http://emberjs.jsbin.com/ucanam/4090/edit">Map to different URL key with colon syntax</a></p></li>
<li><p><a href="http://emberjs.jsbin.com/ucanam/4059">查询</a></p></li>
<li><p><a href="http://emberjs.jsbin.com/ucanam/2937">排序: 客户端，不重新触发模型钩子</a></p></li>
<li><p><a href="http://emberjs.jsbin.com/ucanam/4073">排序: 服务器端，重新触发模型钩子</a></p></li>
<li><p><a href="http://emberjs.jsbin.com/ucanam/4075">分页和排序</a></p></li>
<li><p><a href="http://emberjs.jsbin.com/ucanam/4076/edit">布尔值</a></p></li>
<li><p><a href="http://emberjs.jsbin.com/ucanam/4077/edit">在应用路由中的全局查询参数</a></p></li>
<li><p><a href="http://emberjs.jsbin.com/ucanam/4079/edit">通过设置refreshModel:true实现完整过渡</a></p></li>
<li><p><a href="http://emberjs.jsbin.com/ucanam/4080/edit">通过设置replace:true实现replaceState</a></p></li>
<li><p><a href="http://emberjs.jsbin.com/ucanam/4081">易实现标签的w/ {{partial}}助手</a></p></li>
<li><p><a href="http://emberjs.jsbin.com/ucanam/4082#/about?showThing=true">不带路由名只有查询参数的link-to</a></p></li>
<li><p><a href="http://emberjs.jsbin.com/ucanam/4083/edit">合成：序列化多行文本输入框内容到URL（子表达式）</a></p></li>
<li><p><a href="http://emberjs.jsbin.com/ucanam/4084">数组</a></p></li>
<li><p><a href="http://emberjs.jsbin.com/ucanam/4090/edit">使用冒号语法映射不同的URL键值</a></p></li>
</ul>

    
      <footer>
        
          <a class="previous-guide" href="/bilingual_guides/routing/specifying-the-location-api">
            ← 指定地址API
          </a>
         
        <a class="next-guide" href="/bilingual_guides/routing/asynchronous-routing">
          异步路由 →
        </a>
      
      </footer>
      
  </div>

      </div>
    </div>

    <div id="footer">
      <div id="footer-wrapper">
        <div class="info">&copy; 2014 Emberjs.CN <br/>Design by <a href="http://www.heropixel.com">HeroPixel</a></div>
        <div class="statement"><b>声明：</b>本站的文章可以随意在网上转载，但必须注明原文出处！</div>
        <div class="links">
          <a href="http://weibo.com/embercn"><img src="/images/weibo.png"/></a>
          <a href="http://emberjs.cn/blog/feed.xml"><img src="/images/feed.png"/></a>
        </div>
      </div>
    </div>

<!--[if lt IE 9]>
    <script type="text/javascript" src="/javascripts/common-old-ie.js"></script>
<![endif]-->
<!--[if gte IE 9]><!-->
    <script type="text/javascript" src="/javascripts/common-modern.js"></script>
<!--<![endif]-->

    
    <script type="text/javascript" src="/javascripts/guides.js"></script>
  

    <script type="text/javascript">
      var _gaq = _gaq || [];
      var pluginUrl = '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
      _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
      _gaq.push(['_setAccount', 'UA-38578402-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>

    <script type="text/javascript">
      var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
      document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F0b0fcec01b06cc76e274f7b21f4766c4' type='text/javascript'%3E%3C/script%3E"));

      $(function() {
        $('a[href="http://tongji.baidu.com/hm-web/welcome/ico?s=0b0fcec01b06cc76e274f7b21f4766c4"]').hide();
      });
    </script>

  </body>
</html>
